<div class="import-data-page">
  <h1>Import Data</h1>
  <section class="page-form-section">
    <div>
      <form #importForm="ngForm" >
        <div class="form-group">
          <label for="data-type">Data Type</label>
          <p-select
            id="data-type"
            [options]="dataTypeOptions"
            [(ngModel)]="selectedDataType"
            name="importDataType"
          />
          <label for="file-location">File Location</label>
          <input type="file" id="file-location" name="file" (change)="onFileChange($event)" />
          @if (targetFile.found) {
            <label>File Name</label>
            <div>{{targetFile.name}}</div>
            <label for="orderno">Order #</label>
            <input pInputText type="text" id="orderno" name="orderno" [(ngModel)]="importData.orderno" />
          }
          @if (targetFile.err) {
            <label style="color: #dc2626;font-weight: bold;">File Error:</label>
            <p-message severity="error" variant="simple">{{targetFile.errMsg}}</p-message>
          }
        </div>

        @if(targetFile.showTable){
          <div class="dt-btns">
            <button
              (click)="importFormSubmitted(importForm)"
              pButton
              severity="info"
              class="import-btn"
              pTooltip="Confirm to proceed">
              Import
            </button>
          </div>
          <p-table [value]="targetFile.linesObject"
                   [paginator]="true"
                   [rows]="100"
                   [rowsPerPageOptions]="[150, 200, 250]"
                   styleClass="p-datatable-striped">
            <ng-template pTemplate="header">
              <tr>
                <th>Item Name</th>
                <th>Description</th>
                <th>Quantity</th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-order>
              <tr>
                <td>{{order.item}}</td>
                <td>{{order.description}}</td>
                <td>{{order.qty}} {{order.unit}}</td>
              </tr>
            </ng-template>
            <ng-template #paginatorleft>
              <b>Total lines: {{targetFile.linesObject.length}}</b>
            </ng-template>
          </p-table>
        }
      </form>
    </div>
  </section>
</div>
